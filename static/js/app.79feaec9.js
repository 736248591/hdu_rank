(function(t){function a(a){for(var s,i,r=a[0],l=a[1],c=a[2],u=0,m=[];u<r.length;u++)i=r[u],e[i]&&m.push(e[i][0]),e[i]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);d&&d(a);while(m.length)m.shift()();return n.push.apply(n,c||[]),o()}function o(){for(var t,a=0;a<n.length;a++){for(var o=n[a],s=!0,r=1;r<o.length;r++){var l=o[r];0!==e[l]&&(s=!1)}s&&(n.splice(a--,1),t=i(i.s=o[0]))}return t}var s={},e={app:0},n=[];function i(a){if(s[a])return s[a].exports;var o=s[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=s,i.d=function(t,a,o){i.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:o})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,a){if(1&a&&(t=i(t)),8&a)return t;if(4&a&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var s in t)i.d(o,s,function(a){return t[a]}.bind(null,s));return o},i.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(a,"a",a),a},i.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=a,r=r.slice();for(var c=0;c<r.length;c++)a(r[c]);var d=l;n.push([0,"chunk-vendors"]),o()})({0:function(t,a,o){t.exports=o("56d7")},"1a0a":function(t,a,o){},"56d7":function(t,a,o){"use strict";o.r(a);o("cadf"),o("551c"),o("f751"),o("097d");var s=o("2b0e"),e=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",{attrs:{id:"app"}},[t._m(0),t._m(1),o("div",{staticClass:"py-2"},[o("div",{staticClass:"container"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-md-12"},[o("div",{staticClass:"table-responsive"},[o("table",{staticClass:"table"},[o("caption",[t._v("状态："),o("span",{attrs:{id:"status"}},[t._v(t._s(t.crawlStatus)+"\n                "),o("i",{class:"fa d-inline fa-circle"+t.crawlStatusClass}),t.isAdmin?["stopped"===t.crawlStatus?o("b-button",{attrs:{variant:"link"},on:{click:t.beginCrawl}},[t._v("启动")]):o("b-button",{attrs:{variant:"link"},on:{click:t.stopCrawl}},[t._v("停止")])]:t._e()],2)]),t._m(2),o("tbody",t._l(t.users,function(a,s){return o("tr",{key:a["id"]},[o("td",[t._v(t._s(s+1)+"\n                  "),t.isAdmin?o("i",{staticClass:"fa d-inline fa-lg fa-times text-danger",on:{click:function(o){return t.removeUser(a["id"])}}}):t._e()]),o("td",[t._v(t._s(a["name"]))]),o("td",[t._v(t._s(a["account"]))]),o("td",[t._v(t._s(a["motto"]))]),o("td",["unchecked"===a["status"]?[o("span",{staticClass:"text-warning"},[t._v("待确认")]),t.isAdmin?o("i",{staticClass:"fa d-inline fa-lg fa-check text-success",on:{click:function(o){return t.confirmUser(a["id"])}}}):t._e()]:[t._v(t._s(a["solved_num"]))]],2)])}),0)]),o("div",[o("b-button",{attrs:{variant:"link"},on:{click:function(a){t.addUserModalShow=!0}}},[o("i",{staticClass:"fa fa-plus fa-fw fa-lg py-1"}),o("span",{staticStyle:{"font-size":"110%"}},[t._v("添加账号")])])],1),t.isAdmin?o("div",[o("b-button",{attrs:{variant:"link"},on:{click:function(a){t.addNoticeModalShow=!0}}},[o("i",{staticClass:"fa fa-plus fa-fw fa-lg py-1"}),o("span",{staticStyle:{"font-size":"110%"}},[t._v("添加公告")])])],1):t._e()])])])])]),o("div",{staticClass:"py-2"},[o("div",{staticClass:"container"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-md-12"},[o("vue-markdown",{attrs:{source:t.notice}})],1)])])]),o("div",{staticClass:"py-3"},[o("div",{staticClass:"container"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-md-12 text-center"},[o("p",{staticClass:"mb-0"},[t._v("Writed By 雪靡. All rights reserved |\n            "),t.isAdmin?o("b-button",{attrs:{variant:"link"},on:{click:t.adminLogout}},[t._v("管理员退出")]):o("b-button",{attrs:{variant:"link"},on:{click:function(a){t.adminLoginModalShow=!0}}},[t._v("管理员登录")])],1)])])])]),o("b-modal",{attrs:{id:"addUserModal",title:"添加用户","ok-title":"确认","cancel-title":"取消","ok-disabled":""===t.formUserName||""===t.formAccount},on:{ok:t.addUser},model:{value:t.addUserModalShow,callback:function(a){t.addUserModalShow=a},expression:"addUserModalShow"}},[o("form",{on:{submit:t.addUser}},[o("div",{staticClass:"form-group row"},[o("label",{staticClass:"col-2 col-form-label",attrs:{for:"user_name"}},[t._v("姓名")]),o("div",{staticClass:"col-10"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.formUserName,expression:"formUserName"}],staticClass:"form-control",attrs:{type:"text",id:"user_name",placeholder:"请在这里输入您的姓名。"},domProps:{value:t.formUserName},on:{input:function(a){a.target.composing||(t.formUserName=a.target.value)}}})])]),o("div",{staticClass:"form-group row"},[o("label",{staticClass:"col-2 col-form-label",attrs:{for:"account"}},[t._v("账号")]),o("div",{staticClass:"col-10"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.formAccount,expression:"formAccount"}],staticClass:"form-control",attrs:{type:"text",id:"account",placeholder:"请在这里输入您的杭电的账号名。"},domProps:{value:t.formAccount},on:{input:function(a){a.target.composing||(t.formAccount=a.target.value)}}})]),o("div",{staticClass:"text-right col-12 inline form-text",staticStyle:{margin:"0","font-size":"12px"}},[o("small",{staticClass:"text-right text-danger"},[t._v(" 注意：这里填写的是您杭电的登录账号，不是用户名，请注意！")])])]),o("div",{staticClass:"form-group row"},[o("label",{staticClass:"col-2 col-form-label"},[t._v("格言")]),o("div",{staticClass:"col-10"})])]),o("b-form-textarea",{attrs:{rows:"3"},model:{value:t.formMotto,callback:function(a){t.formMotto=a},expression:"formMotto"}})],1),o("b-modal",{attrs:{id:"adminLoginModal",title:"管理员登录","ok-title":"确认","cancel-title":"取消"},on:{ok:t.adminLogin},model:{value:t.adminLoginModalShow,callback:function(a){t.adminLoginModalShow=a},expression:"adminLoginModalShow"}},[o("b-form",{on:{submit:t.adminLogin}},[o("b-form-group",{attrs:{label:"密码："}},[o("b-form-input",{attrs:{type:"password",required:"",placeholder:"请在这里输入管理员密码。"},model:{value:t.adminPwd,callback:function(a){t.adminPwd=a},expression:"adminPwd"}})],1)],1)],1),o("b-modal",{attrs:{id:"msgModal",size:"sm",title:t.msgTitle,"ok-title":"确认","cancel-title":"取消","ok-only":t.msgOkOnly},on:{ok:t.msgOkCallback,cancel:t.msgCancelCallback},model:{value:t.msgVisible,callback:function(a){t.msgVisible=a},expression:"msgVisible"}},[o("p",{class:t.msgClass,domProps:{innerHTML:t._s(t.msg)}})]),o("b-modal",{attrs:{id:"addNoticeModal",title:"添加公告","ok-title":"确认","cancel-title":"取消",size:"xl"},on:{ok:t.addNotice},model:{value:t.addNoticeModalShow,callback:function(a){t.addNoticeModalShow=a},expression:"addNoticeModalShow"}},[o("form",{on:{submit:t.addNotice}},[o("b-form-textarea",{attrs:{rows:"8"},model:{value:t.newNotice,callback:function(a){t.newNotice=a},expression:"newNotice"}}),o("hr"),o("vue-markdown",{attrs:{source:t.newNotice}})],1)])],1)},n=[function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",{staticClass:"gh-ribbon"},[o("a",{attrs:{href:"https://github.com/736248591/hdu_rank",target:"_blank"}},[t._v("Fork me on GitHub")])])},function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",{staticClass:"py-5"},[o("div",{staticClass:"container"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-md-12"},[o("h1",{staticClass:"text-center shadow-none"},[o("b",{staticStyle:{"font-weight":"bold"}},[t._v("HDU排行榜")])])])])])])},function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("thead",[o("tr",[o("th",[t._v("#")]),o("th",[t._v("姓名")]),o("th",[t._v("账号")]),o("th",[t._v("格言")]),o("th",[t._v("题数")])])])}],i=o("9ce6"),r=o.n(i),l=o("c53e"),c={components:{VueMarkdown:r.a},name:"app",data:function(){return{crawlStatus:"",isAdmin:!1,users:[],formUserName:"",formAccount:"",formMotto:"",msg:"",msgClass:"",msgTitle:"",msgOkCallback:function(){},msgCancelCallback:function(){},msgOkOnly:!1,msgVisible:!1,adminPwd:"",adminLoginModalShow:!1,addUserModalShow:!1,notice:"",newNotice:"",addNoticeModalShow:!1}},methods:{getRank:function(){var t=this;this.$ajax.get("/get_rank").then(function(a){console.log(a),a["status"]&&(t.users=a["users"],t.newNotice=t.notice=a["notice"])})},addUser:function(){var t=this,a={name:this.formUserName,account:this.formAccount,motto:this.formMotto};this.$ajax.get("/add",{params:a}).then(function(a){a.status?t.showMsgModal("提示","操作成功！",function(){t.formUserName="",t.formAccount="",t.formMotto="",t.getRank()}):t.showMsgModal("错误",a.msg)})},removeUser:function(t){var a=this;this.showMsgModal("提示","是否确认删除？",function(){a.$ajax.get("/remove",{params:{id:t}}).then(function(t){t.status?a.getRank():a.showMsgModal("错误",t.msg)})},function(){},!1)},confirmUser:function(t){var a=this;this.$ajax.get("/confirm",{params:{id:t}}).then(function(t){t.status?a.getRank():a.showMsgModal("错误",t.msg)})},adminLogin:function(t){var a=this;t.preventDefault();var o=new l("SHA3-512","TEXT"),s=Math.floor((new Date).getTime()/1e4);console.log("time:"+s),o.update(s+this.adminPwd+s);var e=o.getHash("HEX");console.log("token:"+e),this.$ajax.get("/login_admin",{params:{pwd:e}}).then(function(t){t.status?(a.adminPwd="",a.getLoginInfo(),a.adminLoginModalShow=!1):a.showMsgModal("错误",t["msg"])})},adminLogout:function(){var t=this;this.$ajax.get("/logout_admin").then(function(a){a.status?t.getLoginInfo():t.showMsgModal("错误",a.msg)})},getLoginInfo:function(){var t=this;this.$ajax.get("/get_login_info").then(function(a){a.status?t.isAdmin=a["is_admin"]:t.showMsgModal("错误",a["msg"])})},beginCrawl:function(){var t=this;this.$ajax.get("/crawl_start").then(function(a){a.status?t.getCrawlStatus():t.showMsgModal("错误",a["msg"])})},stopCrawl:function(){var t=this;this.$ajax.get("/crawl_stop").then(function(a){a.status?t.getCrawlStatus():t.showMsgModal("错误",a["msg"])})},getCrawlStatus:function(){var t=this;this.$ajax.get("/crawl_status").then(function(a){a.status?t.crawlStatus=a["crawl_status"]:t.showMsgModal("错误",a["msg"])})},showMsgModal:function(t,a){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},e=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.msgTitle=t,this.msg=a,this.msgOkCallback=o,this.msgCancelCallback=s,this.msgOkOnly=e,this.msgVisible=!0},addNotice:function(){var t=this,a={notice:this.newNotice};this.$ajax.get("/add_notice",{params:a}).then(function(a){a.status?t.showMsgModal("提示","操作成功！",function(){t.getRank()}):t.showMsgModal("错误",a["msg"])})}},computed:{crawlStatusClass:function(){return"stopped"===this.crawlStatus?"text-primary":"text-danger"}},mounted:function(){this.getRank(),this.getLoginInfo(),this.getCrawlStatus()},beforeDestroy:function(){this.formMotto.destroy()}},d=c,u=(o("5c0b"),o("2877")),m=Object(u["a"])(d,e,n,!1,null,null,null),f=m.exports,g=o("5f5b"),h=(o("a2f0"),o("1a0a"),o("bc3a")),v=o.n(h);s["default"].config.productionTip=!1,s["default"].use(g["a"]);var p=v.a.create({baseURL:"/api/"});p.interceptors.response.use(function(t){return t.data},function(t){return console.error(t),Promise.reject(t)}),s["default"].prototype.$ajax=p,new s["default"]({render:function(t){return t(f)}}).$mount("#app")},"5c0b":function(t,a,o){"use strict";var s=o("5e27"),e=o.n(s);e.a},"5e27":function(t,a,o){},a2f0:function(t,a,o){}});