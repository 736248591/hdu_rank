(function(t){function a(a){for(var o,i,r=a[0],c=a[1],l=a[2],u=0,f=[];u<r.length;u++)i=r[u],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&f.push(n[i][0]),n[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);d&&d(a);while(f.length)f.shift()();return s.push.apply(s,l||[]),e()}function e(){for(var t,a=0;a<s.length;a++){for(var e=s[a],o=!0,r=1;r<e.length;r++){var c=e[r];0!==n[c]&&(o=!1)}o&&(s.splice(a--,1),t=i(i.s=e[0]))}return t}var o={},n={app:0},s=[];function i(a){if(o[a])return o[a].exports;var e=o[a]={i:a,l:!1,exports:{}};return t[a].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=t,i.c=o,i.d=function(t,a,e){i.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:e})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,a){if(1&a&&(t=i(t)),8&a)return t;if(4&a&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var o in t)i.d(e,o,function(a){return t[a]}.bind(null,o));return e},i.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(a,"a",a),a},i.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=a,r=r.slice();for(var l=0;l<r.length;l++)a(r[l]);var d=c;s.push([0,"chunk-vendors"]),e()})({0:function(t,a,e){t.exports=e("56d7")},"1a0a":function(t,a,e){},"56d7":function(t,a,e){"use strict";e.r(a);e("cadf"),e("551c"),e("f751"),e("097d");var o=e("2b0e"),n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"app"}},[t._m(0),t._m(1),e("div",{staticClass:"py-2"},[e("div",{staticClass:"container"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table"},[e("caption",[t._v("状态："),e("span",{attrs:{id:"status"}},[t._v(t._s(t.crawlStatus)+"\n                "),e("i",{class:"fa d-inline fa-circle"+t.crawlStatusClass}),t.isAdmin?["stopped"===t.crawlStatus?e("b-button",{attrs:{variant:"link"},on:{click:t.beginCrawl}},[t._v("启动")]):e("b-button",{attrs:{variant:"link"},on:{click:t.stopCrawl}},[t._v("停止")])]:t._e()],2)]),t._m(2),e("tbody",t._l(t.users,(function(a,o){return e("tr",{key:a["id"]},[e("td",[t._v(t._s(o+1)+"\n                  "),t.isAdmin?e("i",{staticClass:"fa d-inline fa-lg fa-times text-danger",on:{click:function(e){return t.removeUser(a["id"])}}}):t._e()]),e("td",[t._v(t._s(a["name"]))]),e("td",[t._v(t._s(a["account"]))]),e("td",[t._v(t._s(a["motto"]))]),e("td",["unchecked"===a["status"]?[e("span",{staticClass:"text-warning"},[t._v("待确认")]),t.isAdmin?e("i",{staticClass:"fa d-inline fa-lg fa-check text-success",on:{click:function(e){return t.confirmUser(a["id"])}}}):t._e()]:[t._v(t._s(a["solved_num"]))]],2)])})),0)]),e("div",[e("b-button",{attrs:{variant:"link"},on:{click:function(a){t.addUserModalShow=!0}}},[e("i",{staticClass:"fa fa-plus fa-fw fa-lg py-1"}),e("span",{staticStyle:{"font-size":"110%"}},[t._v("添加账号")])])],1),t.isAdmin?e("div",[e("b-button",{attrs:{variant:"link"},on:{click:function(a){t.addNoticeModalShow=!0}}},[e("i",{staticClass:"fa fa-plus fa-fw fa-lg py-1"}),e("span",{staticStyle:{"font-size":"110%"}},[t._v("添加公告")])])],1):t._e()])])])])]),e("div",{staticClass:"py-2"},[e("div",{staticClass:"container"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("vue-markdown",{attrs:{source:t.notice}})],1)])])]),e("div",{staticClass:"py-3"},[e("div",{staticClass:"container"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12 text-center"},[e("p",{staticClass:"mb-0"},[t._v("Writed By 雪靡. All rights reserved |\n            "),t.isAdmin?e("b-button",{attrs:{variant:"link"},on:{click:t.adminLogout}},[t._v("管理员退出")]):e("b-button",{attrs:{variant:"link"},on:{click:function(a){t.adminLoginModalShow=!0}}},[t._v("管理员登录")])],1)])])])]),e("b-modal",{attrs:{id:"addUserModal",title:"添加用户","ok-title":"确认","cancel-title":"取消","ok-disabled":t.addUserModalOkDisabled},on:{ok:t.addUser},model:{value:t.addUserModalShow,callback:function(a){t.addUserModalShow=a},expression:"addUserModalShow"}},[e("b-form",{on:{submit:t.addUser}},[e("b-form-group",{attrs:{label:"姓名："}},[e("b-form-input",{attrs:{state:t.formUserNameState,"aria-describedby":"formUserNameFeedback",placeholder:"请在这里输入您的姓名。",required:"",trim:"",type:"text"},model:{value:t.formUserName,callback:function(a){t.formUserName=a},expression:"formUserName"}}),e("b-form-invalid-feedback",{attrs:{id:"formUserNameFeedback"}},[t._v("\n          姓名长度应该在2-16之间。\n        ")])],1),e("b-form-group",{attrs:{label:"账号："}},[e("b-form-input",{attrs:{state:t.formAccountState&&t.formAccountAvailable,placeholder:"请在这里输入您的杭电的账号名。",required:"",trim:""},on:{blur:t.validateFormAccount},model:{value:t.formAccount,callback:function(a){t.formAccount=a},expression:"formAccount"}})],1),e("b-form-invalid-feedback",{attrs:{state:t.formAccountState}},[t._v("\n        账号长度应该在1-64之间。\n      ")]),e("b-form-invalid-feedback",{attrs:{state:t.formAccountAvailable}},[t._v("\n        "+t._s(t.formAccountServerFeedbackString)+"\n      ")]),e("b-form-group",{attrs:{label:"格言："}},[e("b-form-textarea",{attrs:{state:t.formMottoState,rows:"3","aria-describedby":"formMottoFeedback"},model:{value:t.formMotto,callback:function(a){t.formMotto=a},expression:"formMotto"}}),e("b-form-invalid-feedback",{attrs:{id:"formMottoFeedback"}},[t._v("格言长度不应该大于255。")])],1)],1)],1),e("b-modal",{attrs:{id:"adminLoginModal",title:"管理员登录","ok-title":"确认","cancel-title":"取消"},on:{ok:t.adminLogin},model:{value:t.adminLoginModalShow,callback:function(a){t.adminLoginModalShow=a},expression:"adminLoginModalShow"}},[e("b-form",{on:{submit:t.adminLogin}},[e("b-form-group",{attrs:{label:"密码："}},[e("b-form-input",{attrs:{type:"password",required:"",placeholder:"请在这里输入管理员密码。"},model:{value:t.adminPwd,callback:function(a){t.adminPwd=a},expression:"adminPwd"}})],1)],1)],1),e("b-modal",{attrs:{id:"msgModal",size:"sm",title:t.msgTitle,"ok-title":"确认","cancel-title":"取消","ok-only":t.msgOkOnly},on:{ok:t.msgOkCallback,cancel:t.msgCancelCallback},model:{value:t.msgVisible,callback:function(a){t.msgVisible=a},expression:"msgVisible"}},[e("p",{class:t.msgClass,domProps:{innerHTML:t._s(t.msg)}})]),e("b-modal",{attrs:{id:"addNoticeModal",title:"添加公告","ok-title":"确认","cancel-title":"取消",size:"xl"},on:{ok:t.addNotice},model:{value:t.addNoticeModalShow,callback:function(a){t.addNoticeModalShow=a},expression:"addNoticeModalShow"}},[e("form",{on:{submit:t.addNotice}},[e("b-form-textarea",{attrs:{rows:"8"},model:{value:t.newNotice,callback:function(a){t.newNotice=a},expression:"newNotice"}}),e("hr"),e("vue-markdown",{attrs:{source:t.newNotice}})],1)])],1)},s=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"gh-ribbon"},[e("a",{attrs:{href:"https://github.com/736248591/hdu_rank",target:"_blank"}},[t._v("Fork me on GitHub")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"py-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("h1",{staticClass:"text-center shadow-none"},[e("b",{staticStyle:{"font-weight":"bold"}},[t._v("HDU排行榜")])])])])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",[t._v("#")]),e("th",[t._v("姓名")]),e("th",[t._v("账号")]),e("th",[t._v("格言")]),e("th",[t._v("题数")])])])}],i=e("9ce6"),r=e.n(i),c=e("c53e"),l={components:{VueMarkdown:r.a},name:"app",data:function(){return{crawlStatus:"",isAdmin:!1,users:[],formUserName:"",formAccount:"",formAccountAvailable:!1,formAccountServerFeedbackString:"当失去焦点时将验证账号",formMotto:"",msg:"",msgClass:"",msgTitle:"",msgOkCallback:function(){},msgCancelCallback:function(){},msgOkOnly:!1,msgVisible:!1,adminPwd:"",adminLoginModalShow:!1,addUserModalShow:!1,notice:"",newNotice:"",addNoticeModalShow:!1}},methods:{getRank:function(){var t=this;this.$ajax.get("/get_rank").then((function(a){a["status"]&&(t.users=a["users"],t.newNotice=t.notice=a["notice"])}))},validateFormAccount:function(){var t=this;this.formAccountServerFeedbackString="检测中……";var a={account:this.formAccount};this.$ajax.get("/validate_user",{params:a}).then((function(a){a.status?t.formAccountAvailable=!0:(t.formAccountServerFeedbackString=a.msg,t.formAccountAvailable=!1)}))},addUser:function(){var t=this,a={name:this.formUserName,account:this.formAccount,motto:this.formMotto};this.$ajax.get("/add",{params:a}).then((function(a){a.status?t.showMsgModal("提示","操作成功！",(function(){t.formUserName="",t.formAccount="",t.formMotto="",t.getRank()})):t.showMsgModal("错误",a.msg)}))},removeUser:function(t){var a=this;this.showMsgModal("提示","是否确认删除？",(function(){a.$ajax.get("/remove",{params:{id:t}}).then((function(t){t.status?a.getRank():a.showMsgModal("错误",t.msg)}))}),(function(){}),!1)},confirmUser:function(t){var a=this;this.$ajax.get("/confirm",{params:{id:t}}).then((function(t){t.status?a.getRank():a.showMsgModal("错误",t.msg)}))},adminLogin:function(t){var a=this;t.preventDefault();var e=new c("SHA3-512","TEXT"),o=Math.floor((new Date).getTime()/1e4);e.update(o+this.adminPwd+o);var n=e.getHash("HEX");this.$ajax.get("/login_admin",{params:{pwd:n}}).then((function(t){t.status?(a.adminPwd="",a.getLoginInfo(),a.adminLoginModalShow=!1):a.showMsgModal("错误",t["msg"])}))},adminLogout:function(){var t=this;this.$ajax.get("/logout_admin").then((function(a){a.status?t.getLoginInfo():t.showMsgModal("错误",a.msg)}))},getLoginInfo:function(){var t=this;this.$ajax.get("/get_login_info").then((function(a){a.status?t.isAdmin=a["is_admin"]:t.showMsgModal("错误",a["msg"])}))},beginCrawl:function(){var t=this;this.$ajax.get("/crawl_start").then((function(a){a.status?t.getCrawlStatus():t.showMsgModal("错误",a["msg"])}))},stopCrawl:function(){var t=this;this.$ajax.get("/crawl_stop").then((function(a){a.status?t.getCrawlStatus():t.showMsgModal("错误",a["msg"])}))},getCrawlStatus:function(){var t=this;this.$ajax.get("/crawl_status").then((function(a){a.status?t.crawlStatus=a["crawl_status"]:t.showMsgModal("错误",a["msg"])}))},showMsgModal:function(t,a){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.msgTitle=t,this.msg=a,this.msgOkCallback=e,this.msgCancelCallback=o,this.msgOkOnly=n,this.msgVisible=!0},addNotice:function(){var t=this,a={notice:this.newNotice};this.$ajax.get("/add_notice",{params:a}).then((function(a){a.status?t.showMsgModal("提示","操作成功！",(function(){t.getRank()})):t.showMsgModal("错误",a["msg"])}))}},computed:{crawlStatusClass:function(){return"stopped"===this.crawlStatus?"text-primary":"text-danger"},formUserNameState:function(){return this.formUserName.length>1&&this.formUserName.length<=16},formAccountState:function(){return this.formAccount.length>=1&&this.formAccount.length<=64},formMottoState:function(){return this.formMotto.length<=255},addUserModalOkDisabled:function(){return!(this.formUserNameState&&this.formAccountState&&this.formMottoState&&this.formAccountAvailable)}},mounted:function(){this.getRank(),this.getLoginInfo(),this.getCrawlStatus()},beforeDestroy:function(){this.formMotto.destroy()}},d=l,u=(e("5c0b"),e("2877")),f=Object(u["a"])(d,n,s,!1,null,null,null),m=f.exports,h=e("5f5b"),g=(e("a2f0"),e("1a0a"),e("bc3a")),v=e.n(g);o["default"].config.productionTip=!1,o["default"].use(h["a"]);var b=v.a.create({baseURL:"/api/"});b.interceptors.response.use((function(t){return t.data}),(function(t){return Promise.reject(t)})),o["default"].prototype.$ajax=b,new o["default"]({render:function(t){return t(m)}}).$mount("#app")},"5c0b":function(t,a,e){"use strict";var o=e("e332"),n=e.n(o);n.a},a2f0:function(t,a,e){},e332:function(t,a,e){}});